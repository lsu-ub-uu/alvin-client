{% load i18n static metadata_wrangler %}

{% block title %}
<title>Alvin - {{ metadata|alvin_title:metadata.record_type }}</title>
{% endblock %}

{% block jshead %}
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
    crossorigin="">
  </script>
{% endblock %}

<!-- Metadata -->
<div class="flex flex-col">
    <div x-show="activeTab === 'overview' || activeTab === 'all_metadata'" x-cloak>
        {% with metadata.authority_names.label as authority_label %}
            {% for lang, name in metadata.authority_names.names.items %}
                {% include "./_metadata_row.html" with label=authority_label extra_label=name.label_lang value=name|alvin_place_name %}
            {% endfor %}
        {% endwith %}
        {% with metadata.variant_names.label as variant_label %}
            {% for lang, name in metadata.variant_names.names.items %}
                {% with first=name.0|default:name %}
                        {% include "./_metadata_row.html" with label=variant_label extra_label=first.label_lang value=name|alvin_place_name %}
                {% endwith %}
            {% endfor %}
        {% endwith %}
    </div>
    <div x-show="activeTab === 'all_metadata'" x-cloak>
        {% include "./_metadata_row.html" with label=metadata.country.label value=metadata.country.item %}
        {% if metadata.longitude and metadata.latitude %}
            {% include "./_metadata_row.html" with label=metadata.longitude.label value=metadata.longitude.text %}
            {% include "./_metadata_row.html" with label=metadata.latitude.label value=metadata.latitude.text %}
            {% include "./_metadata_row.html" with label="Vägbeskrivning"  url="https://maps.google.com/?q=" value="Google maps" %}
        {% endif %}
        {% include "./_metadata_row.html" with label=metadata.created.label value=metadata.created.text %}
        {% include "./_metadata_row.html" with label=metadata.last_updated.label value=metadata.last_updated.text %}
        {% include "./_metadata_row.html" with label="Källdata" value=metadata.source_xml %}
    </div>
    <div x-show="activeTab === 'overview' || activeTab === 'all_metadata'" x-cloak>
        {% include "./_metadata_row.html" with label="Id" value=metadata.id %}
    </div>
    <div x-show="activeTab === 'related'" x-cloak>
        <!-- Incoming links -->
    </div>
</div>

<!-- Map -->
{% if metadata.latitude and metadata.longitude %}
    <aside class="w-full h-[600px] max-sm:h-[400px] z-0 border-alvin-orange border-4 mb-10" id="map" x-show="activeTab != 'related'" x-cloak></aside>
{% endif %}

{% block jsbody %}
<script defer src="{% static 'js/map.js' %}" 
  data-latitude="{{ metadata.latitude.text }}"
  data-longitude="{{ metadata.longitude.text }}">
</script>
{% endblock %}